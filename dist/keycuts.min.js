!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.keycuts=t():e.keycuts=t()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=5)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!Array.isArray(e))throw new Error("Invalid array shortcut to stringify: "+e);return"string"!=typeof e[0]?e.map(function(e){return e.join(n)}).join(o):e.join(n)};var n=" + ",o=" > "},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("string"!=typeof e)throw new Error("Invalid string shortcut to parse: "+e);if("string"!=typeof(e=e.replace(/\s+/g,""))||0===e.length)throw new Error("Invalid shortcut (must be non empty string): "+e);for(var t=[],r=[],s=[],c=0;c<e.length;c++){var a=e.charAt(c);t.length?a===n?(r.push(u(t)),t=[]):a===o?(r.push(u(t)),t=[],r.sort(),s.push(r),r=[]):t.push(a):t.push(a)}if(!t.length)throw new Error("Invalid shortcut (must end with key): "+e);r.push(u(t)),r.sort(),s.push(r);var l=!0,f=!1,d=void 0;try{for(var h,p=s[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){if(i(h.value).length>0)throw new Error("Invalid shortcut (duplicate keys):"+e)}}catch(e){f=!0,d=e}finally{try{!l&&p.return&&p.return()}finally{if(f)throw d}}return 1===s.length?s[0]:s};var n="+",o=">";function i(e){var t;return t=function(e){return e.reduce(function(e,t){return Object.assign(e,(r={},n=t,o=(e[t]||0)+1,n in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o,r));var r,n,o},{})}(e),Object.keys(t).filter(function(e){return t[e]>1})}function u(e){return 1===(e=e.join("")).length&&(e=e.toLowerCase()),e}},function(e,t,r){"use strict";function n(e){for(var t=0;t<e.length;t++){if("string"!=typeof e[t])throw new Error("Invalid shortcut combo "+e+".");var r=o(e[t]);if(!r)throw new Error("Invalid key "+r+" in shortcut combo "+e+".");e[t]=r}e.sort()}function o(e){return" "===(e=e.replace(/\s+/g," "))&&(e="Space"),1===(e=e.trim()).length&&(e=e.toLowerCase()),e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!Array.isArray(e)||0===e.length)throw new Error("Invalid array shortcut to clean: "+e);var t="string"!=typeof e[0];return t&&1===e.length&&(e=e[0],t=!1),t?function(e){for(var t=0;t<e.length;t++){if(!Array.isArray(e[t]))throw new Error("Invalid shortcut sequence "+e+".");n(e[t])}}(e):n(e),e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return n++};var n=1},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(r(3)),o=s(r(2)),i=s(r(1)),u=s(r(0));function s(e){return e&&e.__esModule?e:{default:e}}function c(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}var a=function e(t,r){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._stopped=!0,this._currentScope=e.DEFAULT_SCOPE,this._currentCombo=[],this._sequence=[],this._handlers=[],this._watchers=[],this.options={triggerOncePerKey:!1,useCodeInsteadKey:!1,maxSequenceLength:3,filter:function(){return!0}},this._onKeyDown=function(e){if(s.options.filter.call(s,e)){var t=s.options.useCodeInsteadKey?e.code:e.key;1===t.length&&" "===(t=t.toLowerCase())&&(t="Space");var r=s._currentCombo.includes(t);r||(s._currentCombo.push(t),s._currentCombo.sort(),0!==s._sequence.length&&s._sequence[s._sequence.length-1]===s._currentCombo||(s._sequence.length===s.options.maxSequenceLength&&s._sequence.shift(),s._sequence.push(s._currentCombo))),r&&s.options.triggerOncePerKey||(s._notifyWatchers(e),s._dispatchHandlers(e))}},this._onKeyUp=function(e){if(s.options.filter.call(s,e)){var t=s.options.useCodeInsteadKey?e.code:e.key;1===t.length&&" "===(t=t.toLowerCase())&&(t="Space"),s._currentCombo=[].concat(c(s._currentCombo));var r=s._currentCombo.indexOf(t);-1!==r&&(s._currentCombo.splice(r,1),s._currentCombo.sort()),s._notifyWatchers(e)}},this._resetKeys=function(){s._currentCombo=[],s._sequence=[]},this._notifyWatchers=function(e){var t=JSON.parse(JSON.stringify(s._sequence)),r=!0,n=!1,o=void 0;try{for(var i,u=s._watchers[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){i.value.callback(t,e)}}catch(e){n=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(n)throw o}}},this._dispatchHandlers=function(e){for(var t=JSON.parse(JSON.stringify(s._sequence)),r=[],n=[],o=s._sequence.length-1;o>=0;o--)n=[s._sequence[o]].concat(c(n)),r.push((0,u.default)(n));var i=!0,a=!1,l=void 0;try{for(var f,d=s._handlers[Symbol.iterator]();!(i=(f=d.next()).done);i=!0){var h=f.value;s._currentScope===h.scope&&r.includes(h.signature)&&h.callback(t,e)}}catch(e){a=!0,l=e}finally{try{!i&&d.return&&d.return()}finally{if(a)throw l}}},this.bind=function(t,r,c){void 0===c&&(c=r,r=e.DEFAULT_SCOPE),"string"==typeof t&&(t=(0,i.default)(t)),t=(0,o.default)(t);var a=(0,n.default)();return s._handlers.push({id:a,signature:(0,u.default)(t),shortcut:t,scope:r,callback:c}),a},this.unbind=function(e){var t=s._handlers.findIndex(function(t){return t.id===e});if(-1===t)throw new Error("Invalid handler ID: "+e);s._handlers.splice(t,1)},this.unbindScope=function(e){var t=[];s._handlers.forEach(function(r,n){r.scope===e&&t.push(n)});var r=!0,n=!1,o=void 0;try{for(var i,u=t[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var c=i.value;s._handlers.splice(c,1)}}catch(e){n=!0,o=e}finally{try{!r&&u.return&&u.return()}finally{if(n)throw o}}},this.unbindAll=function(){s._handlers=[]},this.watch=function(e){var t=(0,n.default)();return s._watchers.push({id:t,callback:e}),t},this.unwatch=function(e){var t=s._watchers.findIndex(function(t){return t.id===e});if(-1===t)throw new Error("Invalid watcher ID: "+e);s._watchers.splice(t,1)},this.unwatchAll=function(){s._watchers=[]},this.switchScope=function(e){s._currentScope=e},this.stop=function(){s._stopped||(s._element.removeEventListener("keydown",s._onKeyDown),s._element.removeEventListener("keyup",s._onKeyUp),s._element.removeEventListener("focus",s._resetKeys),s._element.removeEventListener("blur",s._resetKeys),s._resetKeys(),s._stopped=!0)},this.resume=function(){s._stopped&&(s._element.addEventListener("keydown",s._onKeyDown),s._element.addEventListener("keyup",s._onKeyUp),s._element.addEventListener("focus",s._resetKeys),s._element.addEventListener("blur",s._resetKeys),s._stopped=!1)},this.reset=function(){s._resetKeys(),s.unbindAll(),s.unwatchAll()},t||(t=window),this._element=t,Object.assign(this.options,r),this.resume()};a.DEFAULT_SCOPE="DEFAULT_SCOPE",t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4);Object.defineProperty(t,"Keys",{enumerable:!0,get:function(){return c(n).default}});var o=r(2);Object.defineProperty(t,"cleanShortcut",{enumerable:!0,get:function(){return c(o).default}});var i=r(3);Object.defineProperty(t,"generateId",{enumerable:!0,get:function(){return c(i).default}});var u=r(1);Object.defineProperty(t,"parseShortcut",{enumerable:!0,get:function(){return c(u).default}});var s=r(0);function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"stringifyShortcut",{enumerable:!0,get:function(){return c(s).default}})}])});