!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.keycuts=t():e.keycuts=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("string"!=typeof(e=e.replace(/\s+/g,""))||0===e.length)throw new Error("Invalid signature (must be non empty string): "+e);for(var t=[],n=[],s=[],c=0;c<e.length;c++){var a=e.charAt(c);t.length?a===r?(n.push(i(t)),t=[]):a===o?(n.push(i(t)),t=[],n.sort(),s.push(n),n=[]):t.push(a):t.push(a)}if(!t.length)throw new Error("Invalid signature (must end with key): "+e);n.push(i(t)),n.sort(),s.push(n);var l=!0,f=!1,d=void 0;try{for(var h,p=s[Symbol.iterator]();!(l=(h=p.next()).done);l=!0){if(u(h.value).length>0)throw new Error("Invalid signature (duplicate keys):"+e)}}catch(e){f=!0,d=e}finally{try{!l&&p.return&&p.return()}finally{if(f)throw d}}return 1===s.length?s[0]:s};var r="+",o=">";function u(e){var t;return t=function(e){return e.reduce(function(e,t){return Object.assign(e,(n={},r=t,o=(e[t]||0)+1,r in n?Object.defineProperty(n,r,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[r]=o,n));var n,r,o},{})}(e),Object.keys(t).filter(function(e){return t[e]>1})}function i(e){return 1===(e=e.join("")).length&&(e=e.toLowerCase()),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return"string"!=typeof e[0]?e.map(function(e){return e.join(r)}).join(o):e.join(r)};var r=" + ",o=" > "},function(e,t,n){"use strict";function r(e){for(var t=0;t<e.length;t++){if("string"!=typeof e[t])throw new Error("Invalid shortcut combo "+e+".");var n=o(e[t]);if(!n)throw new Error("Invalid key "+n+" in shortcut combo "+e+".");e[t]=n}e.sort()}function o(e){return" "===(e=e.replace(/\s+/g," "))&&(e="Space"),1===(e=e.trim()).length&&(e=e.toLowerCase()),e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!Array.isArray(e)||0===e.length)throw new Error("Invalid shortcut: "+e);var t="string"!=typeof e[0];return t&&1===e.length&&(e=e[0],t=!1),t?function(e){for(var t=0;t<e.length;t++){if(!Array.isArray(e[t]))throw new Error("Invalid shortcut sequence "+e+".");r(e[t])}}(e):r(e),e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return r++};var r=1},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s(n(3)),o=s(n(2)),u=s(n(1)),i=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}function c(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var a=function e(t,n){var s=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._stopped=!0,this._currentScope=e.DEFAULT_SCOPE,this._currentCombo=[],this._sequence=[],this._handlers=[],this._watchers=[],this.options={triggerOncePerKey:!1,useCodeInsteadKey:!1,maxSequenceLength:3,filter:function(){return!0}},this._onKeyDown=function(e){if(s.options.filter.call(s,e)){var t=s.options.useCodeInsteadKey?e.code:e.key;1===t.length&&" "===(t=t.toLowerCase())&&(t="Space");var n=s._currentCombo.includes(t);n||(s._currentCombo.push(t),s._currentCombo.sort(),0!==s._sequence.length&&s._sequence[s._sequence.length-1]===s._currentCombo||(s._sequence.length===s.options.maxSequenceLength&&s._sequence.shift(),s._sequence.push(s._currentCombo))),n&&s.options.triggerOncePerKey||(s._notifyWatchers(e),s._dispatchHandlers(e))}},this._onKeyUp=function(e){if(s.options.filter.call(s,e)){var t=s.options.useCodeInsteadKey?e.code:e.key;1===t.length&&" "===(t=t.toLowerCase())&&(t="Space"),s._currentCombo=[].concat(c(s._currentCombo));var n=s._currentCombo.indexOf(t);-1!==n&&(s._currentCombo.splice(n,1),s._currentCombo.sort()),s._notifyWatchers(e)}},this._resetKeys=function(){s._currentCombo=[],s._sequence=[]},this._notifyWatchers=function(e){var t=JSON.parse(JSON.stringify(s._sequence)),n=!0,r=!1,o=void 0;try{for(var u,i=s._watchers[Symbol.iterator]();!(n=(u=i.next()).done);n=!0){u.value.callback(t,e)}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}},this._dispatchHandlers=function(e){for(var t=JSON.parse(JSON.stringify(s._sequence)),n=[],r=[],o=s._sequence.length-1;o>=0;o--)r=[s._sequence[o]].concat(c(r)),n.push((0,u.default)(r));var i=!0,a=!1,l=void 0;try{for(var f,d=s._handlers[Symbol.iterator]();!(i=(f=d.next()).done);i=!0){var h=f.value;s._currentScope===h.scope&&n.includes(h.signature)&&h.callback(t,e)}}catch(e){a=!0,l=e}finally{try{!i&&d.return&&d.return()}finally{if(a)throw l}}},this.bind=function(t,n,c){void 0===c&&(c=n,n=e.DEFAULT_SCOPE),"string"==typeof t&&(t=(0,i.default)(t)),t=(0,o.default)(t);var a=(0,r.default)();return s._handlers.push({id:a,signature:(0,u.default)(t),shortcut:t,scope:n,callback:c}),a},this.unbind=function(e){var t=s._handlers.findIndex(function(t){return t.id===e});if(-1===t)throw new Error("Invalid handler ID: "+e);s._handlers.splice(t,1)},this.unbindScope=function(e){var t=[];s._handlers.forEach(function(n,r){n.scope===e&&t.push(r)});var n=!0,r=!1,o=void 0;try{for(var u,i=t[Symbol.iterator]();!(n=(u=i.next()).done);n=!0){var c=u.value;s._handlers.splice(c,1)}}catch(e){r=!0,o=e}finally{try{!n&&i.return&&i.return()}finally{if(r)throw o}}},this.unbindAll=function(){s._handlers=[]},this.watch=function(e){var t=(0,r.default)();return s._watchers.push({id:t,callback:e}),t},this.unwatch=function(e){var t=s._watchers.findIndex(function(t){return t.id===e});if(-1===t)throw new Error("Invalid watcher ID: "+e);s._watchers.splice(t,1)},this.unwatchAll=function(){s._watchers=[]},this.switchScope=function(e){s._currentScope=e},this.stop=function(){s._stopped||(s._element.removeEventListener("keydown",s._onKeyDown),s._element.removeEventListener("keyup",s._onKeyUp),s._element.removeEventListener("focus",s._resetKeys),s._element.removeEventListener("blur",s._resetKeys),s._resetKeys(),s._stopped=!0)},this.resume=function(){s._stopped&&(s._element.addEventListener("keydown",s._onKeyDown),s._element.addEventListener("keyup",s._onKeyUp),s._element.addEventListener("focus",s._resetKeys),s._element.addEventListener("blur",s._resetKeys),s._stopped=!1)},this.reset=function(){s._resetKeys(),s.unbindAll(),s.unwatchAll()},t||(t=window),this._element=t,Object.assign(this.options,n),this.resume()};a.DEFAULT_SCOPE="DEFAULT_SCOPE",t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4);Object.defineProperty(t,"Keys",{enumerable:!0,get:function(){return c(r).default}});var o=n(2);Object.defineProperty(t,"cleanShortcut",{enumerable:!0,get:function(){return c(o).default}});var u=n(3);Object.defineProperty(t,"generateId",{enumerable:!0,get:function(){return c(u).default}});var i=n(0);Object.defineProperty(t,"parseShortcut",{enumerable:!0,get:function(){return c(i).default}});var s=n(1);function c(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"stringifyShortcut",{enumerable:!0,get:function(){return c(s).default}})}])});